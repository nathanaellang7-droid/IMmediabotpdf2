<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SEO PDF Bulk Generator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<style>
body{font-family:Arial;background:#eef1ff}
.container{max-width:1200px;margin:auto;padding:20px}
table{width:100%;border-collapse:collapse}
th,td{border:1px solid #ddd;padding:8px}
input,select{width:100%;padding:6px}
.preview img{width:70px;height:100px;object-fit:cover}
button{padding:12px 22px;margin-top:15px;background:#102060;color:#fff;border:none;cursor:pointer}
</style>
</head>

<body>
<div class="container">
<h1>ðŸ“˜ SEO PDF Bulk Generator</h1>

<table>
<thead>
<tr>
<th>OUTPUT FILE</th>
<th>TITLE PDF</th>
<th>TITLE BOOK</th>
<th>AUTHOR</th>
<th>DOWNLOAD LINK</th>
<th>LANG</th>
<th>ASIN</th>
<th>Preview</th>
</tr>
</thead>
<tbody id="rows"></tbody>
</table>

<button onclick="addRow()">âž• Add Row</button>
<button onclick="generateZIP()">ðŸ“¦ Generate ZIP</button>
</div>

<script>
const rows=document.getElementById('rows');
addRow();

/* ===== JAPANESE FONT ===== */
let JP_FONT=null;
async function loadJapaneseFont(){
  if(JP_FONT) return JP_FONT;
  const r=await fetch('fonts/HeiseiKakuGo-W5.ttf');
  const b=await r.arrayBuffer();
  JP_FONT=btoa([...new Uint8Array(b)].map(x=>String.fromCharCode(x)).join(''));
  return JP_FONT;
}

/* ===== CTA TEXT ===== */
const CTA_TEXT={
  en:"DOWNLOAD PDF",
  es:"DESCARGAR PDF",
  pt:"BAIXAR PDF",
  fr:"TÃ‰LÃ‰CHARGER PDF",
  de:"PDF HERUNTERLADEN",
  it:"SCARICA PDF",
  ja:"PDFã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰",
  ar:"ØªØ­Ù…ÙŠÙ„ PDF"
};

/* ===== SEO TEXT UNDER TITLE ===== */
const TRANSLATIONS={
  en:({t,a})=>`Download or Read Online ${t} free ebook (PDF ePub Mobi) - ${a}`,
  es:({t,a})=>`Descargar o leer online ${t} ebook gratis (PDF ePub Mobi) - ${a}`,
  pt:({t,a})=>`Baixar ou ler online ${t} ebook grÃ¡tis (PDF ePub Mobi) - ${a}`,
  fr:({t,a})=>`TÃ©lÃ©charger ou lire en ligne ${t} ebook gratuit (PDF ePub Mobi) - ${a}`,
  de:({t,a})=>`${t} kostenloses Ebook herunterladen oder online lesen - ${a}`,
  it:({t,a})=>`Scarica o leggi online ${t} ebook gratuito (PDF ePub Mobi) - ${a}`,
  ja:({t,a})=>`${t} ã‚’ç„¡æ–™ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¾ãŸã¯ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã§èª­ã‚€ï¼ˆPDFãƒ»ePubãƒ»Mobiï¼‰ - ${a}`,
  ar:({t,a})=>`ØªØ­Ù…ÙŠÙ„ Ø£Ùˆ Ù‚Ø±Ø§Ø¡Ø© ${t} ÙƒØªØ§Ø¨ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ù…Ø¬Ø§Ù†ÙŠ (PDF ePub Mobi) - ${a}`
};

/* ===== SEO KEYWORDS ===== */
const SEO_KEYWORDS={
  en:(t,a)=>`${t}, ebook pdf, free ebook, download ebook, read online, ${a}`,
  es:(t,a)=>`${t}, ebook pdf, ebook gratis, descargar ebook, ${a}`,
  pt:(t,a)=>`${t}, ebook pdf, ebook grÃ¡tis, baixar ebook, ${a}`,
  fr:(t,a)=>`${t}, ebook pdf, ebook gratuit, tÃ©lÃ©charger ebook, ${a}`,
  de:(t,a)=>`${t}, ebook pdf, kostenloses ebook, herunterladen, ${a}`,
  it:(t,a)=>`${t}, ebook pdf, ebook gratuito, scaricare ebook, ${a}`,
  ja:(t,a)=>`${t}, é›»å­æ›¸ç±, PDF, ç„¡æ–™, ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰, ${a}`,
  ar:(t,a)=>`${t}, ÙƒØªØ§Ø¨ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ, PDF, ØªØ­Ù…ÙŠÙ„, ${a}`
};

/* ===== PAGE TEXT VARIATION (FINAL) ===== */
const PAGE_TEXT={
  en:["This page is part of a limited preview. Return to page 1 to download the full ebook."],
  es:["Esta pÃ¡gina forma parte de una vista previa limitada. Vuelve a la pÃ¡gina 1 para descargar el ebook completo."],
  pt:["Esta pÃ¡gina faz parte de uma prÃ©via limitada. Retorne Ã  pÃ¡gina 1 para baixar o ebook completo."],
  fr:["Cette page fait partie dâ€™un aperÃ§u limitÃ©. Revenez Ã  la page 1 pour tÃ©lÃ©charger lâ€™ebook complet."],
  de:["Diese Seite ist Teil einer eingeschrÃ¤nkten Vorschau. Kehren Sie zu Seite 1 zurÃ¼ck, um das vollstÃ¤ndige Ebook herunterzuladen."],
  it:["Questa pagina fa parte di unâ€™anteprima limitata. Torna alla pagina 1 per scaricare lâ€™ebook completo."],
  ja:["ã“ã®ãƒšãƒ¼ã‚¸ã¯é™å®šãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã®ä¸€éƒ¨ã§ã™ã€‚å®Œå…¨ç‰ˆã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã«ã¯ã€1ãƒšãƒ¼ã‚¸ç›®ã«æˆ»ã£ã¦ãã ã•ã„ã€‚"],
  ar:["Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© Ø¬Ø²Ø¡ Ù…Ù† Ù…Ø¹Ø§ÙŠÙ†Ø© Ù…Ø­Ø¯ÙˆØ¯Ø©. Ø§Ø±Ø¬Ø¹ Ø¥Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙƒØªØ§Ø¨ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ Ø§Ù„ÙƒØ§Ù…Ù„."]
};

/* ===== UTIL ===== */
function slugify(t){
return t.normalize('NFD').replace(/[\u0300-\u036f]/g,'')
.toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/^-+|-+$/g,'');
}

async function loadImg(src){
const i=new Image();i.src=src;
await new Promise(r=>i.onload=r);
const c=document.createElement('canvas');
c.width=i.width;c.height=i.height;
c.getContext('2d').drawImage(i,0,0);
return c.toDataURL('image/jpeg',0.55);
}

/* ===== UI ===== */
function addRow(){
const tr=document.createElement('tr');
tr.innerHTML=`
<td><input class="out"></td>
<td><input class="pdf"></td>
<td><input class="title"></td>
<td><input class="author"></td>
<td><input class="link"></td>
<td>
<select class="lang">
<option value="en">EN</option><option value="es">ES</option>
<option value="pt">PT</option><option value="fr">FR</option>
<option value="de">DE</option><option value="it">IT</option>
<option value="ja">JA</option><option value="ar">AR</option>
</select></td>
<td><input class="asin" oninput="preview(this)"></td>
<td class="preview"><img></td>`;
rows.appendChild(tr);
}

function preview(el){
el.closest('tr').querySelector('img').src=
`https://images-na.ssl-images-amazon.com/images/P/${el.value}.01.LZZZZZZZ.jpg`;
}

/* ===== PDF ===== */
async function buildPDF(d){
const {jsPDF}=window.jspdf;
const doc=new jsPDF({unit:'pt',format:'a4',compress:true,putOnlyUsedFonts:true});
const W=595,H=842;

/* SEO METADATA */
doc.setProperties({
  title:d.title_pdf,
  author:d.author,
  subject:d.title_book,
  keywords:(SEO_KEYWORDS[d.lang]||SEO_KEYWORDS.en)(d.title_book,d.author)
});

/* COVER */
const cover=new Image();
cover.src=`https://images-na.ssl-images-amazon.com/images/P/${d.asin}.01.LZZZZZZZ.jpg`;
await new Promise(r=>cover.onload=r);
doc.addImage(cover,'JPEG',(W-220)/2,40,220,330);

/* TITLE */
doc.setFont('times','bold');doc.setFontSize(18);
doc.text(d.title_pdf,W/2,410,{align:'center'});

/* BODY FONT */
if(d.lang==='ja'){
  const f=await loadJapaneseFont();
  doc.addFileToVFS('jp.ttf',f);
  doc.addFont('jp.ttf','jp','normal');
  doc.setFont('jp','normal');
}else doc.setFont('times','normal');

doc.setFontSize(12);
doc.text(TRANSLATIONS[d.lang]({t:d.title_book,a:d.author}),W/2,460,{align:'center',maxWidth:420});

/* BUTTON */
const x=(W-280)/2,y=685;
doc.setFillColor(16,32,96);
doc.roundedRect(x,y,280,52,10,10,'F');
doc.setTextColor(255,255,255);doc.setFontSize(16);
doc.text(CTA_TEXT[d.lang],W/2,y+32,{align:'center'});
doc.link(x,y,280,52,{url:d.link});
doc.setTextColor(0,0,0);

/* PAGES */
const total=Math.random()>0.5?21:20;
for(let i=1;i<total;i++){
doc.addPage();
if(i<10){
  doc.addImage(await loadImg(`previews/p${(i%4)+1}.jpg`),'JPEG',0,0,W,H);
}else{
  doc.text(
    `${d.title_book}\n\n${PAGE_TEXT[d.lang][0]}\n\n${CTA_TEXT[d.lang]}`,
    40,80,{maxWidth:520}
  );
}}
return doc.output('blob');
}

/* ===== ZIP ===== */
async function generateZIP(){
const zip=new JSZip();
for(const tr of rows.querySelectorAll('tr')){
const d={
output:tr.querySelector('.out').value,
title_pdf:tr.querySelector('.pdf').value,
title_book:tr.querySelector('.title').value,
author:tr.querySelector('.author').value,
link:tr.querySelector('.link').value,
lang:tr.querySelector('.lang').value,
asin:tr.querySelector('.asin').value
};
if(!d.asin)continue;
const name=d.lang==='ja'?`${d.asin}.pdf`:`${slugify(d.output||d.title_book)}.pdf`;
zip.file(name,await buildPDF(d));
}
saveAs(await zip.generateAsync({type:'blob'}),'bulk-pdfs.zip');
}
</script>
</body>
</html>
